"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1190],{1190:(F,g,i)=>{i.r(g),i.d(g,{RamosPageModule:()=>D});var m=i(177),f=i(4341),l=i(4742),u=i(4964),d=i(467),a=i(3953),h=i(7133),p=i(2518),v=i(9415);function R(s,t){if(1&s&&(a.j41(0,"ion-item")(1,"ion-label")(2,"h1"),a.EFF(3,"Asistencia"),a.k0s(),a.j41(4,"p"),a.EFF(5),a.k0s(),a.j41(6,"p"),a.EFF(7),a.k0s()()()),2&s){const c=t.$implicit,o=a.XpG();a.R7$(5),a.SpI("Porcentaje: ",c.total_asistencia/(null==o.seccion?null:o.seccion.total_clases)*100,"%"),a.R7$(2),a.Lme("N\xb0 de clases: ",c.total_asistencia,"/ ",null==o.seccion?null:o.seccion.total_clases,"")}}const y=[{path:"",component:(()=>{var s;class t{constructor(o,e,n){this.router=o,this.menuCtrl=e,this.route=n,this.firebaseSvc=(0,a.WQX)(h.f),this.utilsSvc=(0,a.WQX)(p.T),this.seccionId=null,this.seccion=null,this.asignatura=null,this.asistenciaData=[],this.userId=""}ngOnInit(){var o=this;return(0,d.A)(function*(){o.seccionId=o.route.snapshot.paramMap.get("seccionId"),console.log("ID de la secci\xf3n:",o.seccionId);const e=o.utilsSvc.getFromLocalStorage("user");o.userId=e?e.uid:"",o.seccionId?(yield o.loadSeccionData(o.seccionId),yield o.loadAsistenciaData(o.userId,o.seccionId)):console.error("Secci\xf3n ID no proporcionado")})()}loadSeccionData(o){var e=this;return(0,d.A)(function*(){const n=yield e.utilsSvc.loading();yield n.present();try{if(e.seccion=yield e.firebaseSvc.getSeccionById(o),!e.seccion)throw new Error(`Secci\xf3n no encontrada para el ID: ${o}`);console.log("Datos de la secci\xf3n:",e.seccion),yield e.loadAsignaturaAndProfesor(e.seccion.asignatura,e.seccion.profesor)}catch(r){e.handleError(r)}finally{n.dismiss()}})()}loadAsignaturaAndProfesor(o,e){var n=this;return(0,d.A)(function*(){if(o?(n.asignatura=yield n.firebaseSvc.getAsignaturaById(o),console.log("Datos de la asignatura:",n.asignatura)):console.error("La secci\xf3n no tiene una asignatura v\xe1lida"),e){const r=yield n.firebaseSvc.getUserById(e);r?(n.seccion.profesor=`${r.name} ${r.lastname}`,console.log("Datos del profesor:",r)):console.error("Profesor no encontrado para el UID:",e)}else console.error("La secci\xf3n no tiene un UID de profesor v\xe1lido")})()}loadAsistenciaData(o,e){var n=this;return(0,d.A)(function*(){try{n.asistenciaData=yield n.firebaseSvc.getAsistenciaPorEstudianteYSeccion(o,e),0===n.asistenciaData.length&&(console.log("No hay registros de asistencia, mostrando 0"),n.asistenciaData=[{total_asistencia:0}]),console.log("Datos de asistencia:",n.asistenciaData)}catch(r){console.error("Error obteniendo los datos de asistencia:",r),n.asistenciaData=[{total_asistencia:0}]}})()}handleError(o){console.error("Error al cargar los datos de la secci\xf3n:",o)}Marcar(){console.log("Marcar asistencia"),this.router.navigate(["/main-estudiante/marcar",this.seccionId])}}return(s=t).\u0275fac=function(o){return new(o||s)(a.rXU(u.Ix),a.rXU(l._t),a.rXU(u.nX))},s.\u0275cmp=a.VBU({type:s,selectors:[["app-ramos"]],decls:13,vars:4,consts:[["titulo","Asistencia"],[1,"ion-padding"],[4,"ngFor","ngForOf"],["color","tertiary","shape","round","expand","block",1,"ion-padding",3,"click"]],template:function(o,e){1&o&&(a.nrm(0,"app-encabezado",0),a.j41(1,"ion-content",1)(2,"ion-item")(3,"ion-label")(4,"h1"),a.EFF(5),a.k0s(),a.j41(6,"p"),a.EFF(7),a.k0s(),a.j41(8,"p"),a.EFF(9),a.k0s()()(),a.DNE(10,R,8,3,"ion-item",2),a.j41(11,"ion-button",3),a.bIt("click",function(){return e.Marcar()}),a.EFF(12,"Marcar Asistencia"),a.k0s()()),2&o&&(a.R7$(5),a.JRh(null==e.asignatura?null:e.asignatura.nombre),a.R7$(2),a.SpI("Profesor: ",null==e.seccion?null:e.seccion.profesor,""),a.R7$(2),a.SpI("Aula: ",null==e.seccion?null:e.seccion.aula,""),a.R7$(),a.Y8G("ngForOf",e.asistenciaData))},dependencies:[m.Sq,l.Jm,l.W9,l.uz,l.he,v.w]}),t})()}];let I=(()=>{var s;class t{}return(s=t).\u0275fac=function(o){return new(o||s)},s.\u0275mod=a.$C({type:s}),s.\u0275inj=a.G2t({imports:[u.iI.forChild(y),u.iI]}),t})();var P=i(5553);let D=(()=>{var s;class t{}return(s=t).\u0275fac=function(o){return new(o||s)},s.\u0275mod=a.$C({type:s}),s.\u0275inj=a.G2t({imports:[m.MD,f.YN,l.bv,I,P.h]}),t})()}}]);